"use strict";(self.webpackChunkmapbox_react_app=self.webpackChunkmapbox_react_app||[]).push([[337],{6755:function(e,t,n){var s=n(885),i=n(2791),r=(n(3508),n(184));t.Z=function(e){var t,n=e.eventForAnalysisComponent,o=(e.showChart,(0,i.useState)(!0)),a=(0,s.Z)(o,2),l=a[0],c=a[1];return(0,r.jsxs)("div",{className:"floating-info-box-event-analysis",children:[(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start"},children:[(0,r.jsxs)("h5",{style:{margin:"0",marginRight:"1rem",textAlign:"left"},children:["Start Time: ",n.Event_Impact_Start]}),(0,r.jsxs)("h5",{style:{margin:"0",textAlign:"left"},children:[" End Time: ",n.Event_Impact_End]})]}),(0,r.jsxs)("p",{children:[l?(t=n.Event_Impact_Analysis,t.length>200?t.substring(0,200)+"...  ":t):n.Event_Impact_Analysis,(0,r.jsx)("span",{children:"       "}),n.Event_Impact_Analysis.length>200&&(0,r.jsx)("span",{style:{color:"white",cursor:"pointer",textDecoration:"underline"},onClick:function(){c(!l)},children:l?"Show more":"Show less"})]})]})}},2337:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var s=n(885),i=n(2791),r=(n(3508),n(6681)),o=n(5718),a=n(184);var l=function(e){var t=e.event,n=e.visualiseEventImpact,s=e.map,i=(0,r.f)(),l=i.setShowChartData,c=i.removeAllButOneMarker,u=i.addAntline,d=i.removeAntline,p=i.addMarker;return(0,a.jsxs)("div",{className:"floating-info-box-event-card",children:[(0,a.jsx)("h2",{style:{marginTop:"0px"},children:t.Event_Name}),(0,a.jsx)("p",{children:t.description}),(0,a.jsx)("button",{className:"floating-nav-cta-button",onClick:function(){d(s.current),n(t.Event_ID),l(!0),c(t.Event_ID);var e,i=(e=t.Event_ID,o.R.find((function(t){return t.properties.event_id===e})));setTimeout((function(){u(s.current,i)}),1e3);var r=i.geometry.coordinates[i.geometry.coordinates.length-1];p(s.current,r)},children:"Visualise Event Impact"})]})},c=(n(550),n(3077)),u=n(3644),d=n(1752);u.kL.register(d.Z);var p=function(e){var t=e.map,n=(0,r.f)(),o=n.neighbourhoods,l=n.eventID,u=n.eventComparisonData,d=n.zoneID,p=n.setZoneID,h=n.zone,f=n.setZone,v=o.features,m=v.map((function(e){return e.properties.zone})),x=v.map((function(e){return e.properties.location_id})),g=(0,i.useState)("4"),y=(0,s.Z)(g,2),b=y[0],j=y[1],S=(0,i.useState)([]),C=(0,s.Z)(S,2),I=C[0],E=C[1],Z=(0,i.useState)([]),w=(0,s.Z)(Z,2),D=w[0],N=w[1];t.current.setPaintProperty(d+"-line","line-width",4);var k=m.map((function(e,t){return(0,a.jsx)("option",{value:e,"data-zone-id":x[t],children:e},t)})),_=[[9,12],[19,22],[11,17],[12,17],[18,23],[13,16],[11,13],[20,22]],B={labels:D,datasets:[{label:"Busyness Score",data:I,fill:{target:"origin",above:"rgba(255, 0, 0, 0.4)",below:"rgba(0, 255, 0, 0.4)"},borderColor:"rgb(255, 255, 255, 0.7)",tension:.1}]},L={responsive:!0,maintainAspectRatio:!1,aspectRatio:4,plugins:{legend:{display:!1},annotation:{annotations:{startLine:{type:"line",mode:"vertical",scaleID:"x",value:_[l-1][0],borderColor:"rgba(255, 99, 132, 0.9)",borderWidth:2,label:{content:"Start",display:!0,position:"start",backgroundColor:"rgba(255, 99, 132)"}},endLine:{type:"line",mode:"vertical",scaleID:"x",value:_[l-1][1],borderColor:"rgba(255, 99, 132, 0.9)",borderWidth:2,label:{content:"End",display:!0,position:"start",backgroundColor:"rgba(255, 99, 132)"}},line1:{type:"line",mode:"horizontal",scaleID:"y",value:0,borderColor:"rgba(0, 0, 0, 0.7)",borderWidth:2}}}},scales:{x:{grid:{color:"#D3D3D310"},ticks:{color:"#D3D3D3"}},y:{grid:{color:"#D3D3D310"},ticks:{color:"#D3D3D3"}}}};return(0,i.useEffect)((function(){var e=[],n=[];for(var s in u){var i=u[s][d],r=s;e.push(100*i),n.push(r)}E(e),N(n),b!==d&&t.current&&(t.current.setPaintProperty(b+"-line","line-width",0),j(d))}),[d,u,t,b]),(0,a.jsxs)("div",{children:[(0,a.jsx)("select",{className:"floating-nav-dropdown",value:h,onChange:function(e){p(e.target.options[e.target.selectedIndex].dataset.zoneId),f(e.target.value)},children:k}),(0,a.jsxs)("div",{className:"line-chart-container",children:[(0,a.jsx)("h3",{style:{display:"flex",flexDirection:"row",margin:"0px",justifyContent:"center"},children:"+/- Change in Busyness"}),(0,a.jsx)(c.x1,{options:L,data:B})]})]})},h=n(9806),f=n(1632),v=function(e){var t=e.title,n=e.content,r=(0,i.useState)(!1),o=(0,s.Z)(r,2),l=o[0],c=o[1];return(0,a.jsxs)("div",{className:"accordion-item-mobile",children:[(0,a.jsxs)("div",{className:"accordion-title ".concat(l?"pressed":""),onClick:function(){return c(!l)},children:["        ",(0,a.jsx)("div",{className:"acc-title",children:t}),(0,a.jsx)(h.G,{icon:l?f.mTx:f.ptq,style:{fontSize:"12px"}})]}),l&&(0,a.jsx)("div",{className:"accordion-content",children:n})]})};var m=function(e){var t=e.map,n=e.hashMap,o=e.busynessHashMap,l=e.eventBaselineHashMap,c=e.colours,u=e.highlightEventImpact,d=e.resetColours,m=(0,r.f)().neighbourhoods,x=(0,r.f)(),g=(x.showChart,x.setShowChart,x.isSplitView),y=x.setSplitView,b=(0,r.f)().updateLayerColours,j=(0,i.useState)(null),S=(0,s.Z)(j,2),C=S[0],I=S[1],E=(0,i.useState)(null),Z=(0,s.Z)(E,2),w=Z[0],D=Z[1],N=(0,i.useState)(null),k=(0,s.Z)(N,2),_=(k[0],k[1],(0,i.useState)([])),B=(0,s.Z)(_,2),L=(B[0],B[1],(0,i.useState)(!1)),A=(0,s.Z)(L,2),M=(A[0],A[1],(0,i.useState)(null)),O=(0,s.Z)(M,2),z=(O[0],O[1]),F=(0,i.useState)(!1),T=(0,s.Z)(F,2),H=T[0],G=T[1],R=(0,i.useState)([]),P=(0,s.Z)(R,2),V=P[0],W=P[1],q=(0,i.useState)(!0),J=(0,s.Z)(q,2),Q=J[0],K=J[1];(0,i.useEffect)((function(){var e=function(){if(!n)return{names:[],dataValues:[]};var e,t=Object.entries(n);H?(t.sort((function(e,t){return t[1]-e[1]})),e=t.slice(0,5)):(t.sort((function(e,t){return e[1]-t[1]})),e=t.slice(0,5));var i=Object.fromEntries(e),r=i?Object.values(i):[];return{names:e.map((function(e){var t=(0,s.Z)(e,1)[0],n=m.features.find((function(e){return e.id===t}));return n?n.properties.zone:null})),dataValues:r}}(),t=e.names,i=e.dataValues;W(V);var r=function(e,t){var n={labels:e,datasets:[{label:"Change in Busyness",barThickness:24,data:t,backgroundColor:function(e){var t=e.chart;return t.chartArea?e.dataIndex>=0?H?U(t):X(t):"white":null}}]};return{data:n,options:{maintainAspectRatio:!1,responsive:!0,indexAxis:"x",scales:{x:{beginAtZero:!0,ticks:{color:"white",font:{size:10},maxRotation:45,minRotation:45},grid:{display:!1}},y:{display:!1,grid:{display:!1}}},plugins:{legend:{display:!1},tooltip:{},title:{display:!0,text:"Change in Busyness",color:"white",font:{size:14,family:"Arial"},align:"center"}}}}}(t,i);z(r)}),[H,n]);var U=function(e){var t=e.ctx,n=e.chartArea,s=n.top,i=n.bottom,r=t.createLinearGradient(0,s,0,i);return r.addColorStop(0,c[2]),r.addColorStop(1,c[1]),r},X=function(e){var t=e.ctx,n=e.chartArea,s=n.top,i=n.bottom,r=t.createLinearGradient(0,s,0,i);return r.addColorStop(0,c[1]),r.addColorStop(1,c[0]),r},Y=function(){K(!Q)};(0,i.useEffect)((function(){b(t.current,!Q,l,o),d(),G(!H)}),[Q]),(0,i.useEffect)((function(){0!==V.length&&(w===C?(d(),b(t.current,!1,l,o),I(null),D(null)):(I(w),u(V)))}),[V]);var $=[{title:"Display Line Chart Analysis",content:(0,a.jsx)(p,{map:t})},{title:"Filter Zones By",content:(0,a.jsxs)("div",{className:"button-tile-icons-container",children:[(0,a.jsxs)("div",{className:"button-tile-icons ".concat("Busiest Zones"===w?"pressed":""),title:"Highlight Busiest Zones",onClick:function(){W(function(){if(!o)return[];var e,t=Object.entries(o);t.sort((function(e,t){return t[1]-e[1]})),e=t.slice(0,8);var n=Object.fromEntries(e);return n?Object.keys(n):[]}()),D("Busiest Zones")},children:[(0,a.jsx)(h.G,{icon:f.ShZ,style:{fontSize:"16px"}}),(0,a.jsx)("span",{children:"Most Busy"})]}),(0,a.jsxs)("div",{className:"button-tile-icons ".concat("Least Busy Zones"===w?"pressed":""),title:"Highlight Least Busy Zones",onClick:function(){W(function(){if(!o)return[];var e,t=Object.entries(o);t.sort((function(e,t){return e[1]-t[1]})),e=t.slice(0,8);var n=Object.fromEntries(e);return n?Object.keys(n):[]}()),D("Least Busy Zones")},children:[(0,a.jsx)(h.G,{icon:f.rRz,style:{fontSize:"16px"}}),(0,a.jsx)("span",{children:"Least Busy"})]}),(0,a.jsxs)("div",{className:"button-tile-icons ".concat("Most Impacted Zones"===w?"pressed":""),title:"Highlight Zones Most Impacted by Event",onClick:function(){W(function(){if(!n)return[];var e,t=Object.entries(n);t.sort((function(e,t){return t[1]-e[1]})),e=(e=t.filter((function(e){return e[1]>=.22}))).slice(0,8);var s=Object.fromEntries(e);return s?Object.keys(s):[]}()),D("Most Impacted Zones")},children:[(0,a.jsx)(h.G,{icon:f.imS,style:{fontSize:"16px"}}),(0,a.jsx)("span",{children:"Most Impacted"})]}),(0,a.jsxs)("div",{className:"button-tile-icons ".concat("Least Impacted Zones"===w?"pressed":""),title:"Highlight Zones Least Impacted by Event",onClick:function(){W(function(){if(!n)return[];var e,t=Object.entries(n);t.sort((function(e,t){return e[1]-t[1]})),e=t.filter((function(e){return e[1]<=-.11}));var s=Object.fromEntries(e);return s?Object.keys(s):[]}()),D("Least Impacted Zones")},children:[(0,a.jsx)(h.G,{icon:f.jAQ,style:{fontSize:"16px"}}),(0,a.jsx)("span",{children:"Least Impacted"})]})]})}];return(0,a.jsxs)("div",{className:"parent-chart-container",children:[(0,a.jsx)("div",{className:"accordion",children:$.map((function(e){var t=e.title,n=e.content;return(0,a.jsx)(v,{title:t,content:n},t)}))}),(0,a.jsxs)("div",{className:"floating-infobox-box-button-container",children:[(0,a.jsxs)("div",{className:"radio-button",children:[(0,a.jsx)("input",{type:"radio",name:"chartDataOption",value:"baselineBusyness",id:"baselineBusyness",checked:!Q,onChange:Y}),(0,a.jsx)("label",{htmlFor:"baselineBusyness",children:"Turn off Event Impact"}),(0,a.jsx)("input",{type:"radio",name:"chartDataOption",value:"eventImpact",id:"eventImpact",checked:Q,onChange:Y}),(0,a.jsx)("label",{htmlFor:"eventImpact",children:"Show Impact of Event"})]}),(0,a.jsx)("button",{className:"floating-nav-cta-button",onClick:function(){return y(!g)},children:g?"Show Original":"Display Dual Map Comparison"})]})]})},x=n(6755),g=n(7729);var y=function(e){var t=e.map,n=e.visualiseEventImpact,o=e.highlightEventImpact,c=e.originalBusynessHashMap,u=e.eventBaselineHashMap,d=e.busynessHashMap,p=e.hashMapOfDifference,v=e.colours,y=e.resetColours,b=e.updateLayerColours,j=e.isNeighbourhoodClickedRef,S=e.showNoEventInfobox,C=e.setShowNoEventInfobox,I=e.eventSelected,E=e.setEventSelected,Z=(0,r.f)(),w=Z.showInfoBox,D=Z.showChartData,N=Z.showChart,k=Z.showNeighborhoodInfoBox,_=Z.neighbourhoodEvents,B=Z.colourPairs,L=Z.colourPairIndex,A=Z.removeAntline,M=(0,r.f)(),O=M.zoneID,z=M.setZoneID,F=M.eventName,T=M.setEventName,H=M.zone,G=M.setZone,R=M.useOriginal,P=M.removeMarker,V=(0,r.f)(),W=V.setShowInfoBox,q=V.setShowNeighborhoodInfoBox,J=V.setShowChart,Q=V.setShowChartData,K=(0,r.f)(),U=K.neighbourhoods,X=K.originalLat,Y=K.originalLng,$=K.setNeighbourhoodEvents,ee=K.showAllMarkers,te=K.setShowMatchingEvent,ne=(0,r.f)(),se=ne.eventForAnalysisComponent,ie=ne.setEventForAnalysisComponent,re=(0,r.f)(),oe=re.setIsFloatingNavVisible,ae=re.setIsTimelapseVisible,le=re.isTimelapseVisible,ce=(0,i.useState)(null),ue=(0,s.Z)(ce,2),de=ue[0],pe=ue[1],he=(0,i.useState)(null),fe=(0,s.Z)(he,2),ve=fe[0],me=fe[1];(0,i.useEffect)((function(){_&&_.length>0&&!I&&(z(_[0].Zone_ID),T(_[0].Event_Name),G(_[0].Zone_Name),ie(_[0]))}),[_]),(0,i.useEffect)((function(){var e=(0,g.Z)().domain([0,.4,.8]).range(B[L]),t=R?u[O]:d[O],n=e(t);me(n),pe(t<.29?"Not Very Busy":t>=.29&&t<.4?"Relatively Busy":t>=.4&&t<.7?"Busy":"Extremely Busy")}),[B,L,d,u,O]);var xe=_?_.map((function(e,s){return(0,a.jsx)(l,{event:e,visualiseEventImpact:n,map:t},s)})):null;return(w||k)&&(0,a.jsxs)("div",{className:"floating-info-box",children:[(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[(0,a.jsxs)("button",{className:"floating-info-box-back-button",onClick:function(){A(t.current),function(e){q(!1),E(!1),J(!1),C(!0),ae(!1),te(!0),W(!1),Q(!1),$([]),ee(e.current),e.current.flyTo({zoom:12,essential:!0,center:[Y,X]}),b(e.current,!0,c,d),U.features.forEach((function(t){e.current.setPaintProperty(t.id,"fill-opacity",.6),e.current.setPaintProperty(t.id+"-line","line-width",0)})),j.current=!1}(t),P(),oe(!0)},children:[(0,a.jsx)(h.G,{icon:f.acZ})," ",(0,a.jsx)("span",{style:{marginLeft:"8px"},children:"Go Back"})]}),I?le?(0,a.jsxs)("button",{className:"floating-info-box-show-hide-timelapse",onClick:function(){return ae(!le)},children:[(0,a.jsx)(h.G,{icon:f.Aq})," ",(0,a.jsx)("span",{style:{marginLeft:"8px"},children:"Hide Timelapse "})]}):(0,a.jsxs)("button",{className:"floating-info-box-show-hide-timelapse",onClick:function(){return ae(!le)},children:[(0,a.jsx)(h.G,{icon:f.Mdf})," ",(0,a.jsx)("span",{style:{marginLeft:"8px"},children:" Show Timelapse"})]}):null]}),(0,a.jsx)("h1",{className:"floating-info-box-zone-header",children:D?F:H}),D?N?null:(0,a.jsx)(x.Z,{eventForAnalysisComponent:se,showChart:N}):(0,a.jsxs)("h3",{className:"floating-info-box-zone-busyness-sub-header",children:[" ",H," is ",(0,a.jsx)("span",{style:{color:ve},children:de})]}),w?D?(0,a.jsx)(m,{map:t,hashMap:p,busynessHashMap:d,eventBaselineHashMap:u,colours:v,highlightEventImpact:o,zoneID:O,resetColours:y}):xe:null,0==k||0==S?void 0:(0,a.jsx)("p",{style:{padding:"0 8px"},children:"There are no events happening in this neighbourhood."})]})}},5718:function(e){e.exports=JSON.parse('{"R":[{"type":"Feature","properties":{"event_id":1},"geometry":{"type":"LineString","coordinates":[[-73.97445794659279,40.78320054331186],[-73.97178264380298,40.782075471097116],[-73.97254550173312,40.781043263735036],[-73.97383296202548,40.779288457699444],[-73.97550666040553,40.776818652150425],[-73.97735202015788,40.77451125084601],[-73.9787253111364,40.77239877093378],[-73.98112857034879,40.7693111794727],[-73.98164355446572,40.76823861412708],[-73.9791115492241,40.76693851171058],[-73.97632205192403,40.765735894330085],[-73.97730910486005,40.76453325486405],[-73.97863948049549,40.76258298296675],[-73.97958361804321,40.76115274720393],[-73.98087107833554,40.75929989602592],[-73.9823302000002,40.75744699320075],[-73.98366057563564,40.755464004896794],[-73.98593508881879,40.75260319624424],[-73.98786627925729,40.74990482073345],[-73.99069869190046,40.75104270327711]]}},{"type":"Feature","properties":{"event_id":2},"geometry":{"type":"LineString","coordinates":[[-74.00998756906033,40.72077406744276],[-74.00527652522013,40.72065510089226],[-74.00482571497633,40.72365565373364],[-74.00348274043711,40.72696619630172],[-74.0022135556644,40.729695033256974],[-73.99960139635807,40.73360915315616],[-73.99781568296005,40.73603579188477],[-73.99589714784503,40.738719528792515]]}},{"type":"Feature","properties":{"event_id":3},"geometry":{"type":"LineString","coordinates":[[-73.96584697111207,40.77405699602288],[-73.96655611030047,40.77313263336668],[-73.9693764331742,40.76927026171949],[-73.97123276576524,40.76680868421986],[-73.9730304773331,40.764337148935255],[-73.97489983683673,40.7616731157927],[-73.9772251376927,40.75860441194606],[-73.97863204240313,40.75663089411062],[-73.97994775882992,40.754830007947724]]}},{"type":"Feature","properties":{"event_id":4},"geometry":{"type":"LineString","coordinates":[[-73.98827317513489,40.743445456942574],[-73.99138453758505,40.739112776494345],[-73.99317625324193,40.736673995496986],[-73.99505379953685,40.7340074925564],[-73.99636271752483,40.73230835414034],[-73.99954918189664,40.73364978277279],[-73.99922731680857,40.73417821692973],[-74.00282147685174,40.73370669126825],[-74.00068693286151,40.73722753522851],[-73.99923237456369,40.73922908196207]]}},{"type":"Feature","properties":{"event_id":5},"geometry":{"type":"LineString","coordinates":[[-73.98145743166602,40.76788685337508],[-73.97627322916328,40.76572371022391],[-73.98640162479674,40.75170701805531],[-73.99206584604971,40.754070610401925],[-73.98224946260703,40.767596014704004]]}},{"type":"Feature","properties":{"event_id":6},"geometry":{"type":"LineString","coordinates":[[-73.99710984338547,40.7178750692777],[-73.9984856263301,40.715649603477004],[-73.9988719445014,40.71497613191858],[-73.99859508314692,40.71349251833956],[-73.99733311045398,40.71412208207628],[-73.99392707198389,40.71430265352081],[-73.99276167885282,40.71650851384046],[-73.99295483795785,40.71821166131109]]}},{"type":"Feature","properties":{"event_id":7},"geometry":{"type":"LineString","coordinates":[[-73.95200584670602,40.7930550804651],[-73.95112575977947,40.794256270502146],[-73.94471723958652,40.791600485293486],[-73.9423372862977,40.79476301608791],[-73.94006889324318,40.7979629309389],[-73.94232489071689,40.797784640621266]]}},{"type":"Feature","properties":{"event_id":8},"geometry":{"type":"LineString","coordinates":[[-73.97489999621705,40.73513251962613],[-73.97373870351373,40.73134287245169],[-73.97198878928002,40.72658321411803],[-73.9744981152197,40.72183335018933],[-73.97477822602225,40.718896579459255],[-73.97600954642573,40.715539479497174]]}}]}')}}]);
//# sourceMappingURL=337.b769ea67.chunk.js.map