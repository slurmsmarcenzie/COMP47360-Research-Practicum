"use strict";(self.webpackChunkmapbox_react_app=self.webpackChunkmapbox_react_app||[]).push([[556],{8556:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var o=n(1413),a=n(885),r=n(2791),i=n(3183),s=n(5483),l=n.n(s),u=n(9944),c=n(6681),p=(n(3508),n(9806)),f=n(1632),d=n(184);var h=function(e){var t=e.topMap,n=e.bottomMap,o=e.originalBusynessHashMap,i=e.timelapseData,s=e.baselineTimelapseData,l=e.busynessHashMap,u=(0,c.f)(),h=u.updateLayerColours,m=u.neighbourhoodEvents,v=(0,r.useState)(!1),b=(0,a.Z)(v,2),y=b[0],g=b[1],w=(0,r.useState)(0),x=(0,a.Z)(w,2),S=x[0],M=x[1],C=(0,r.useState)(0),j=(0,a.Z)(C,2),P=j[0],Z=j[1],k=(0,r.useState)(null),N=(0,a.Z)(k,2),D=(N[0],N[1]),E=(0,r.useRef)(null);(0,r.useEffect)((function(){D(m[0])}),[m]);var B=function(){g(!1),clearInterval(E.current)};return(0,r.useEffect)((function(){if(S>=24&&function(){var e=s[16];Z(0),M(0),g(!1),clearInterval(E.current),setTimeout((function(){h(t.current,!1,l,e),h(n.current,!1,l,l)}),400)}(),Number.isInteger(S)&&i&&i.hasOwnProperty(P)){var e=i[P],a=s[P];h(n.current,!1,o,e),h(t.current,!1,o,a),Z(P+1)}}),[S]),(0,r.useEffect)((function(){return function(){E.current&&clearInterval(E.current)}}),[]),(0,d.jsxs)("div",{className:"timelapse-container-mobile",children:[(0,d.jsxs)("button",{className:"timelapse-button",onClick:function(){y?B():(g(!0),E.current=setInterval((function(){M((function(e){return e+1}))}),1e3))},children:[y?(0,d.jsx)(p.G,{icon:f.XQY,style:{color:"#D3D3D3"}}):(0,d.jsx)(p.G,{icon:f.zc,style:{color:"#D3D3D3"}}),(0,d.jsx)("label",{htmlFor:"toggle",className:"timelapse-label",children:y?"pause":"play"})]}),(0,d.jsxs)("div",{className:"slider-container-parent",children:[(0,d.jsx)("div",{className:"slider-context-container",children:(0,d.jsxs)("p",{className:"elapsed-time-text",children:[" Local Time: ",S>=10?"":0,S,":00 ",S>=12?"PM":"AM"]})}),(0,d.jsx)("div",{className:"slider-container",children:(0,d.jsx)("input",{type:"range",min:"0",max:"24",value:S,onChange:function(e){B();var a=Number(e.target.value);M(a);var r=Math.floor(a);if(i&&i.hasOwnProperty(r)){var l=i[r],u=s[r];h(n.current,!1,o,l),h(t.current,!1,o,u),Z(r)}}})})]})]})},m=(n(3161),n(7729)),v={position:"absolute",top:"0",width:"100%",height:"50vh"},b={position:"absolute",bottom:"0",width:"100%",height:"50vh"};var y=function(e){var t=e.eventBaselineHashMap,n=e.busynessHashMap,s=e.timelapseData,p=e.baselineTimelapseData,f=(0,c.f)(),y=f.MAPBOX_ACCESS_TOKEN,g=f.isSplitView,w=f.setSplitView,x=f.renderNeighbourhoods,S=(f.markers,f.mapStyle),M=(0,c.f)().updateLayerColours,C=(0,c.f)(),j=C.colourPairs,P=C.colourPairIndex,Z=C.neighbourhoods,k=(0,r.useRef)(),N=(0,r.useRef)(),D=(0,r.useRef)(null),E=(0,r.useState)({longitude:-73.9857,latitude:40.7484,zoom:11.2,pitch:30}),B=(0,a.Z)(E,2),T=B[0],L=B[1],H=(0,r.useState)("side-by-side"),V=(0,a.Z)(H,2),R=V[0],A=(V[1],(0,r.useState)("left")),I=(0,a.Z)(A,2),_=I[0],O=I[1],F=(0,r.useCallback)((function(){return O("top")}),[]),z=(0,r.useCallback)((function(){return O("bottom")}),[]),G=(0,r.useCallback)((function(e){return L(e.viewState)}),[]),X="undefined"===typeof window?100:window.innerHeight,q=(0,r.useMemo)((function(){return{top:"split-screen"===R?X/2:0,left:0,right:0,bottom:0}}),[X,R]),K=(0,r.useMemo)((function(){return{bottom:"split-screen"===R?X/2:0,top:0,left:0,right:0}}),[X,R]),Q=("undefined"===typeof window||window.innerWidth,function(e,t){var n=(0,m.Z)().domain([0,.4,.8]).range(j[P]);Z.features.forEach((function(o){e.on("mousemove",o.id,(function(a){e.getCanvas().style.cursor="pointer",e.setPaintProperty(o.id,"fill-opacity",.9),e.setPaintProperty(o.id+"-line","line-width",4);var r=e.queryRenderedFeatures(a.point,{layers:[o.id]});if(r.length>0){if(!D.current){var i=10,s={top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-10],"bottom-left":[5,-5],"bottom-right":[-5,-5],left:[i,-0],right:[-10,-0]};D.current=new(l().Popup)({offset:s,closeButton:!1,closeOnClick:!1})}var u,c=r[0].properties.zone,p=t[o.id],f=n(p);u=p<.29?"Not Very Busy":p>=.29&&p<.4?"Relatively Busy":p>=.4&&p<.7?"Busy":"Extremely Busy",D.current.setLngLat(a.lngLat).setHTML("".concat(c,': <span style="color: ').concat(f,'">').concat(u,'</span>\n          <br>\n          Busyness Score:  <span style="color: ').concat(f,'">').concat(Math.floor(100*p),"</span>\n          ")).addTo(e)}})),e.on("mouseleave",o.id,(function(){e.getCanvas().style.cursor="",e.setPaintProperty(o.id,"fill-opacity",.6),e.setPaintProperty(o.id+"-line","line-width",0),D.current&&(D.current.remove(),D.current=null)}))}))}),W=(0,r.useCallback)((function(e){var o=e.target;k.current=o,x(o),M(o,!1,t,n),Q(o,t)}),[x]),Y=(0,r.useCallback)((function(e){var o=e.target;N.current=o,x(o),M(o,!0,t,n),Q(o,n)}),[x]);return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{style:{position:"relative",height:"100vh"},children:[(0,d.jsx)(i.ZP,(0,o.Z)((0,o.Z)({id:"top-map"},T),{},{padding:q,onMoveStart:F,onMove:"top"===_?G:void 0,style:v,mapStyle:S,mapboxAccessToken:y,onLoad:function(e){return W(e)}})),(0,d.jsx)(i.ZP,(0,o.Z)((0,o.Z)({id:"bottom-map"},T),{},{padding:K,onMoveStart:z,onMove:"bottom"===_?G:void 0,style:b,mapStyle:S,mapboxAccessToken:y,onLoad:function(e){return Y(e)}})),(0,d.jsx)(u.Z,{isSplitView:g,setSplitView:w}),(0,d.jsx)(h,{topMap:k,bottomMap:N,eventBaselineHashMap:t,busynessHashMap:n,baselineTimelapseData:p,timelapseData:s})]})})}},9944:function(e,t,n){var o=n(2791),a=n(6681),r=n(184);t.Z=function(e){var t=e.isSplitView,n=e.setSplitView,i=(0,a.f)(),s=i.setEventForAnalysisComponent,l=i.setShowChart,u=i.neighbourhoodEvents;return(0,o.useEffect)((function(){u&&u.length>0&&s(u[0])}),[u]),(0,r.jsx)("div",{className:"split-view-controller",children:(0,r.jsx)("button",{className:"split-view-controller-toggle-button",onClick:function(){l(!1),n(!t)},children:t?"Return to Single Map View":"Show Splitview"})})}}}]);
//# sourceMappingURL=556.e5d5cf51.chunk.js.map