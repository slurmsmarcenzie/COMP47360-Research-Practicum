"use strict";(self.webpackChunkmapbox_react_app=self.webpackChunkmapbox_react_app||[]).push([[515],{6755:function(e,t,n){var i=n(885),s=n(2791),o=(n(3508),n(184));t.Z=function(e){var t,n=e.eventForAnalysisComponent,r=(e.showChart,(0,s.useState)(!0)),a=(0,i.Z)(r,2),l=a[0],c=a[1];return(0,o.jsxs)("div",{className:"floating-info-box-event-analysis",children:[(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start"},children:[(0,o.jsxs)("h5",{style:{margin:"0",marginRight:"1rem",textAlign:"left"},children:["Start Time: ",n.Event_Impact_Start]}),(0,o.jsxs)("h5",{style:{margin:"0",textAlign:"left"},children:[" End Time: ",n.Event_Impact_End]})]}),(0,o.jsxs)("p",{children:[l?(t=n.Event_Impact_Analysis,t.length>200?t.substring(0,200)+"...  ":t):n.Event_Impact_Analysis,(0,o.jsx)("span",{children:"       "}),n.Event_Impact_Analysis.length>200&&(0,o.jsx)("span",{style:{color:"white",cursor:"pointer",textDecoration:"underline"},onClick:function(){c(!l)},children:l?"Show more":"Show less"})]})]})}},1515:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var i=n(885),s=n(2791),o=(n(3508),n(6681)),r=n(5718),a=n(184);var l=function(e){var t=e.event,n=e.visualiseEventImpact,i=e.map,s=(0,o.f)(),l=s.setShowChartData,c=s.removeAllButOneMarker,u=s.addAntline,d=s.removeAntline,p=s.addMarker;return(0,a.jsxs)("div",{className:"floating-info-box-event-card-mobile",children:[(0,a.jsx)("h2",{style:{marginTop:"0px"},children:t.Event_Name}),(0,a.jsx)("p",{children:t.description}),(0,a.jsx)("button",{className:"floating-nav-cta-button",onClick:function(){d(i.current),n(t.Event_ID),l(!0),c(t.Event_ID);var e,s=(e=t.Event_ID,r.R.find((function(t){return t.properties.event_id===e})));setTimeout((function(){u(i.current,s)}),1e3);var o=s.geometry.coordinates[s.geometry.coordinates.length-1];p(i.current,o)},children:"Visualise Event Impact"})]})},c=n(9806),u=n(1632),d=function(e){var t=e.title,n=e.content,r=e.onClick,l=(0,s.useState)(!1),d=(0,i.Z)(l,2),p=d[0],h=d[1],f=(0,o.f)(),v=f.isAccordionActive,m=f.setIsAccordionActive;return(0,a.jsxs)("div",{className:"accordion-item-mobile",children:[(0,a.jsxs)("div",{className:"accordion-title ".concat(p?"pressed":""),onClick:function(){h(!p),m(!v),r&&r()},children:[(0,a.jsx)("div",{className:"acc-title",children:t}),(0,a.jsx)(c.G,{icon:p?u.mTx:u.ptq,style:{fontSize:"12px"}})]}),p&&(0,a.jsx)("div",{className:"accordion-content",children:n})]})},p=n(3077),h=(n(550),n(3644)),f=n(1752);h.kL.register(f.Z);var v=function(e){var t=e.map,n=(0,o.f)(),r=n.neighbourhoods,l=n.eventID,c=n.eventComparisonData,u=n.zoneID,d=n.setZoneID,h=n.zone,f=n.setZone,v=r.features,m=v.map((function(e){return e.properties.zone})),g=v.map((function(e){return e.properties.location_id})),y=(0,s.useState)("4"),b=(0,i.Z)(y,2),x=b[0],j=b[1],S=(0,s.useState)([]),C=(0,i.Z)(S,2),I=C[0],Z=C[1],E=(0,s.useState)([]),D=(0,i.Z)(E,2),k=D[0],w=D[1];t.current.setPaintProperty(u+"-line","line-width",4);var N=m.map((function(e,t){return(0,a.jsx)("option",{value:e,"data-zone-id":g[t],children:e},t)})),A=[[9,12],[19,22],[11,17],[12,17],[18,23],[13,16],[11,13],[20,22]],_={labels:k,datasets:[{label:"Busyness Score",data:I,fill:{target:"origin",above:"rgba(255, 0, 0, 0.4)",below:"rgba(0, 255, 0, 0.4)"},borderColor:"rgb(255, 255, 255, 0.7)",tension:.1}]},B={responsive:!0,maintainAspectRatio:!1,aspectRatio:4,plugins:{legend:{display:!1},annotation:{annotations:{startLine:{type:"line",mode:"vertical",scaleID:"x",value:A[l-1][0],borderColor:"rgba(255, 99, 132, 0.9)",borderWidth:2,label:{content:"Start",display:!0,position:"start",backgroundColor:"rgba(255, 99, 132)"}},endLine:{type:"line",mode:"vertical",scaleID:"x",value:A[l-1][1],borderColor:"rgba(255, 99, 132, 0.9)",borderWidth:2,label:{content:"End",display:!0,position:"start",backgroundColor:"rgba(255, 99, 132)"}},line1:{type:"line",mode:"horizontal",scaleID:"y",value:0,borderColor:"rgba(0, 0, 0, 0.7)",borderWidth:2}}}},scales:{x:{grid:{color:"#D3D3D310"},ticks:{color:"#D3D3D3"}},y:{grid:{color:"#D3D3D310"},ticks:{color:"#D3D3D3"}}}};return(0,s.useEffect)((function(){var e=[],n=[];for(var i in c){var s=c[i][u],o=i;e.push(100*s),n.push(o)}Z(e),w(n),x!==u&&t.current&&(t.current.setPaintProperty(x+"-line","line-width",0),j(u))}),[u,c,t,x]),(0,a.jsxs)("div",{children:[(0,a.jsx)("select",{className:"floating-nav-dropdown",value:h,onChange:function(e){d(e.target.options[e.target.selectedIndex].dataset.zoneId),f(e.target.value)},children:N}),(0,a.jsx)("div",{className:"line-chart-container-mobile",children:(0,a.jsx)(p.x1,{options:B,data:_})})]})};var m=function(e){var t=e.map,n=e.hashMap,r=e.busynessHashMap,l=e.eventBaselineHashMap,p=e.colours,h=e.highlightEventImpact,f=e.resetColours,m=(0,o.f)().neighbourhoods,g=(0,o.f)(),y=(g.showChart,g.setShowChart,g.isSplitView),b=g.setSplitView,x=(0,o.f)().updateLayerColours,j=(0,s.useState)(null),S=(0,i.Z)(j,2),C=S[0],I=S[1],Z=(0,s.useState)(null),E=(0,i.Z)(Z,2),D=E[0],k=E[1],w=(0,s.useState)(null),N=(0,i.Z)(w,2),A=(N[0],N[1],(0,s.useState)([])),_=(0,i.Z)(A,2),B=(_[0],_[1],(0,s.useState)(!1)),L=(0,i.Z)(B,2),O=(L[0],L[1],(0,o.f)()),z=O.isAccordionActive,M=(O.setIsAccordionActive,(0,s.useState)(null)),F=(0,i.Z)(M,2),H=(F[0],F[1]),R=(0,s.useState)(!1),P=(0,i.Z)(R,2),T=P[0],G=P[1],V=(0,s.useState)([]),W=(0,i.Z)(V,2),q=W[0],J=W[1],Q=(0,s.useState)(!0),K=(0,i.Z)(Q,2),U=K[0],X=K[1],Y=(0,s.useState)(!1),$=(0,i.Z)(Y,2),ee=$[0],te=$[1];(0,s.useEffect)((function(){var e=function(){if(!n)return{names:[],dataValues:[]};var e,t=Object.entries(n);T?(t.sort((function(e,t){return t[1]-e[1]})),e=t.slice(0,5)):(t.sort((function(e,t){return e[1]-t[1]})),e=t.slice(0,5));var s=Object.fromEntries(e),o=s?Object.values(s):[];return{names:e.map((function(e){var t=(0,i.Z)(e,1)[0],n=m.features.find((function(e){return e.id===t}));return n?n.properties.zone:null})),dataValues:o}}(),t=e.names,s=e.dataValues;J(q);var o=function(e,t){var n={labels:e,datasets:[{label:"Change in Busyness",barThickness:24,data:t,backgroundColor:function(e){var t=e.chart;return t.chartArea?e.dataIndex>=0?T?ne(t):ie(t):"white":null}}]};return{data:n,options:{maintainAspectRatio:!1,responsive:!0,indexAxis:"x",scales:{x:{beginAtZero:!0,ticks:{color:"white",font:{size:10},maxRotation:45,minRotation:45},grid:{display:!1}},y:{display:!1,grid:{display:!1}}},plugins:{legend:{display:!1},tooltip:{},title:{display:!0,text:"Change in Busyness",color:"white",font:{size:14,family:"Arial"},align:"center"}}}}}(t,s);H(o)}),[T,n]);var ne=function(e){var t=e.ctx,n=e.chartArea,i=n.top,s=n.bottom,o=t.createLinearGradient(0,i,0,s);return o.addColorStop(0,p[2]),o.addColorStop(1,p[1]),o},ie=function(e){var t=e.ctx,n=e.chartArea,i=n.top,s=n.bottom,o=t.createLinearGradient(0,i,0,s);return o.addColorStop(0,p[1]),o.addColorStop(1,p[0]),o},se=function(){X(!U)};(0,s.useEffect)((function(){x(t.current,!U,l,r),f(),G(!T)}),[U]),(0,s.useEffect)((function(){0!==q.length&&(D===C?(f(),x(t.current,!1,l,r),I(null),k(null)):(I(D),h(q)))}),[q]);var oe=[{title:"Display Line Chart Analysis",content:(0,a.jsx)(v,{map:t}),toggleChartDisplay:function(){return te(!ee)}},{title:"Filter Zones By",content:(0,a.jsxs)("div",{className:"button-tile-icons-container-mobile",children:[(0,a.jsxs)("div",{className:"button-tile-icons-mobile ".concat("Busiest Zones"===D?"pressed":""),title:"Highlight Busiest Zones",onClick:function(){J(function(){if(!r)return[];var e,t=Object.entries(r);t.sort((function(e,t){return t[1]-e[1]})),e=t.slice(0,8);var n=Object.fromEntries(e);return n?Object.keys(n):[]}()),k("Busiest Zones")},children:[(0,a.jsx)(c.G,{icon:u.ShZ}),(0,a.jsx)("span",{style:{fontSize:"10px"},children:"Most Busy"})]}),(0,a.jsxs)("div",{className:"button-tile-icons-mobile ".concat("Least Busy Zones"===D?"pressed":""),title:"Highlight Least Busy Zones",onClick:function(){J(function(){if(!r)return[];var e,t=Object.entries(r);t.sort((function(e,t){return e[1]-t[1]})),e=t.slice(0,8);var n=Object.fromEntries(e);return n?Object.keys(n):[]}()),k("Least Busy Zones")},children:[(0,a.jsx)(c.G,{icon:u.rRz}),(0,a.jsx)("span",{style:{fontSize:"10px"},children:"Least Busy"})]}),(0,a.jsxs)("div",{className:"button-tile-icons-mobile ".concat("Most Impacted Zones"===D?"pressed":""),title:"Highlight Zones Most Impacted by Event",onClick:function(){J(function(){if(!n)return[];var e,t=Object.entries(n);t.sort((function(e,t){return t[1]-e[1]})),e=(e=t.filter((function(e){return e[1]>=.22}))).slice(0,8);var i=Object.fromEntries(e);return i?Object.keys(i):[]}()),k("Most Impacted Zones")},children:[(0,a.jsx)(c.G,{icon:u.imS}),(0,a.jsx)("span",{style:{fontSize:"10px"},children:"Most Impacted"})]}),(0,a.jsxs)("div",{className:"button-tile-icons-mobile ".concat("Least Impacted Zones"===D?"pressed":""),title:"Highlight Zones Least Impacted by Event",onClick:function(){J(function(){if(!n)return[];var e,t=Object.entries(n);t.sort((function(e,t){return e[1]-t[1]})),e=t.filter((function(e){return e[1]<=-.11}));var i=Object.fromEntries(e);return i?Object.keys(i):[]}()),k("Least Impacted Zones")},children:[(0,a.jsx)(c.G,{icon:u.jAQ}),(0,a.jsx)("span",{style:{fontSize:"10px"},children:"Least Impacted"})]})]})}];return(0,a.jsxs)("div",{className:"parent-chart-container",children:[(0,a.jsx)("div",{className:"accordion-mobile",children:oe.map((function(e,t){var n=e.index,i=e.title,s=e.content,o=e.toggleChartDisplay;return 0===t?(0,a.jsx)(d,{title:i,content:s,index:n,onClick:o},i):1!==t||ee?null:(0,a.jsx)(d,{title:i,content:s,index:n},i)}))}),!ee&&!z&&(0,a.jsxs)("div",{className:"floating-infobox-box-button-container",children:[(0,a.jsxs)("div",{className:"radio-button",children:[(0,a.jsx)("input",{type:"radio",name:"chartDataOption",value:"baselineBusyness",id:"baselineBusyness",checked:!U,onChange:se}),(0,a.jsx)("label",{htmlFor:"baselineBusyness",children:"Baseline"}),(0,a.jsx)("input",{type:"radio",name:"chartDataOption",value:"eventImpact",id:"eventImpact",checked:U,onChange:se}),(0,a.jsx)("label",{htmlFor:"eventImpact",children:"Event Impact"})]}),(0,a.jsx)("button",{className:"floating-nav-cta-button",onClick:function(){return b(!y)},children:y?"Show Original":"Display Dual Map Comparison"})]})]})},g=n(6755),y=n(7729);var b=function(e){var t=e.map,n=e.visualiseEventImpact,r=e.highlightEventImpact,d=e.originalBusynessHashMap,p=e.eventBaselineHashMap,h=e.busynessHashMap,f=e.hashMapOfDifference,v=e.colours,b=e.resetColours,x=e.updateLayerColours,j=e.isNeighbourhoodClickedRef,S=(0,o.f)(),C=S.showInfoBox,I=S.showChartData,Z=S.showChart,E=S.showNeighborhoodInfoBox,D=S.neighbourhoodEvents,k=S.colourPairs,w=S.colourPairIndex,N=S.removeAntline,A=S.setIsThereALiveInfoBox,_=(0,o.f)(),B=_.zoneID,L=_.setZoneID,O=_.eventName,z=_.setEventName,M=_.zone,F=_.setZone,H=_.useOriginal,R=(0,o.f)(),P=R.setShowInfoBox,T=R.setShowNeighborhoodInfoBox,G=R.setShowChart,V=R.setShowChartData,W=(0,o.f)(),q=W.neighbourhoods,J=W.originalLat,Q=W.originalLng,K=W.setNeighbourhoodEvents,U=W.showAllMarkers,X=W.setShowMatchingEvent,Y=(0,o.f)(),$=Y.eventForAnalysisComponent,ee=Y.setEventForAnalysisComponent,te=(0,o.f)().setIsTimelapseVisible,ne=(0,s.useState)(null),ie=(0,i.Z)(ne,2),se=ie[0],oe=ie[1],re=(0,s.useState)(null),ae=(0,i.Z)(re,2),le=ae[0],ce=ae[1];(0,s.useEffect)((function(){D&&D.length>0&&(L(D[0].Zone_ID),z(D[0].Event_Name),F(D[0].Zone_Name),ee(D[0]))}),[D]),(0,s.useEffect)((function(){var e=(0,y.Z)().domain([0,.4,.8]).range(k[w]),t=H?p[B]:h[B],n=e(t);ce(n),oe(t<.29?"Not Very Busy":t>=.29&&t<.4?"Relatively Busy":t>=.4&&t<.7?"Busy":"Extremely Busy")}),[k,w,h,p,B]);var ue=D?D.map((function(e,i){return(0,a.jsx)(l,{event:e,visualiseEventImpact:n,map:t},i)})):null,de=(0,o.f)().isDrawerOpen;return(C||E)&&(0,a.jsxs)("div",{className:"floating-info-box ".concat(de?"open":""),children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"left",width:"100%"},children:[(0,a.jsx)("button",{className:"floating-info-box-back-button-mobile",onClick:function(){N(t.current),function(e){te(!1),A(!1),X(!0),P(!1),T(!1),V(!1),G(!1),K([]),U(e.current),e.current.flyTo({zoom:12,essential:!0,center:[Q,J]}),x(e.current,!0,d,h),q.features.forEach((function(t){e.current.setPaintProperty(t.id,"fill-opacity",.6),e.current.setPaintProperty(t.id+"-line","line-width",0)})),j.current=!1}(t)},children:(0,a.jsx)(c.G,{icon:u.acZ})}),(0,a.jsx)("h2",{className:"floating-info-box-zone-header-mobile",children:I?O:M})]}),I?Z?null:(0,a.jsx)(g.Z,{eventForAnalysisComponent:$}):(0,a.jsxs)("h4",{style:{width:"100%"},className:"floating-info-box-zone-busyness-sub-header-mobile",children:[" ",M," is ",(0,a.jsx)("span",{style:{color:le},children:se})]}),C?I?(0,a.jsx)(m,{map:t,hashMap:f,busynessHashMap:h,eventBaselineHashMap:p,colours:v,highlightEventImpact:r,zoneID:B,resetColours:b}):ue:null,E&&(0,a.jsx)("p",{children:"There are no events happening in this neighbourhood."})]})}},5718:function(e){e.exports=JSON.parse('{"R":[{"type":"Feature","properties":{"event_id":1},"geometry":{"type":"LineString","coordinates":[[-73.97445794659279,40.78320054331186],[-73.97178264380298,40.782075471097116],[-73.97254550173312,40.781043263735036],[-73.97383296202548,40.779288457699444],[-73.97550666040553,40.776818652150425],[-73.97735202015788,40.77451125084601],[-73.9787253111364,40.77239877093378],[-73.98112857034879,40.7693111794727],[-73.98164355446572,40.76823861412708],[-73.9791115492241,40.76693851171058],[-73.97632205192403,40.765735894330085],[-73.97730910486005,40.76453325486405],[-73.97863948049549,40.76258298296675],[-73.97958361804321,40.76115274720393],[-73.98087107833554,40.75929989602592],[-73.9823302000002,40.75744699320075],[-73.98366057563564,40.755464004896794],[-73.98593508881879,40.75260319624424],[-73.98786627925729,40.74990482073345],[-73.99069869190046,40.75104270327711]]}},{"type":"Feature","properties":{"event_id":2},"geometry":{"type":"LineString","coordinates":[[-74.00998756906033,40.72077406744276],[-74.00527652522013,40.72065510089226],[-74.00482571497633,40.72365565373364],[-74.00348274043711,40.72696619630172],[-74.0022135556644,40.729695033256974],[-73.99960139635807,40.73360915315616],[-73.99781568296005,40.73603579188477],[-73.99589714784503,40.738719528792515]]}},{"type":"Feature","properties":{"event_id":3},"geometry":{"type":"LineString","coordinates":[[-73.96584697111207,40.77405699602288],[-73.96655611030047,40.77313263336668],[-73.9693764331742,40.76927026171949],[-73.97123276576524,40.76680868421986],[-73.9730304773331,40.764337148935255],[-73.97489983683673,40.7616731157927],[-73.9772251376927,40.75860441194606],[-73.97863204240313,40.75663089411062],[-73.97994775882992,40.754830007947724]]}},{"type":"Feature","properties":{"event_id":4},"geometry":{"type":"LineString","coordinates":[[-73.98827317513489,40.743445456942574],[-73.99138453758505,40.739112776494345],[-73.99317625324193,40.736673995496986],[-73.99505379953685,40.7340074925564],[-73.99636271752483,40.73230835414034],[-73.99954918189664,40.73364978277279],[-73.99922731680857,40.73417821692973],[-74.00282147685174,40.73370669126825],[-74.00068693286151,40.73722753522851],[-73.99923237456369,40.73922908196207]]}},{"type":"Feature","properties":{"event_id":5},"geometry":{"type":"LineString","coordinates":[[-73.98145743166602,40.76788685337508],[-73.97627322916328,40.76572371022391],[-73.98640162479674,40.75170701805531],[-73.99206584604971,40.754070610401925],[-73.98224946260703,40.767596014704004]]}},{"type":"Feature","properties":{"event_id":6},"geometry":{"type":"LineString","coordinates":[[-73.99710984338547,40.7178750692777],[-73.9984856263301,40.715649603477004],[-73.9988719445014,40.71497613191858],[-73.99859508314692,40.71349251833956],[-73.99733311045398,40.71412208207628],[-73.99392707198389,40.71430265352081],[-73.99276167885282,40.71650851384046],[-73.99295483795785,40.71821166131109]]}},{"type":"Feature","properties":{"event_id":7},"geometry":{"type":"LineString","coordinates":[[-73.95200584670602,40.7930550804651],[-73.95112575977947,40.794256270502146],[-73.94471723958652,40.791600485293486],[-73.9423372862977,40.79476301608791],[-73.94006889324318,40.7979629309389],[-73.94232489071689,40.797784640621266]]}},{"type":"Feature","properties":{"event_id":8},"geometry":{"type":"LineString","coordinates":[[-73.97489999621705,40.73513251962613],[-73.97373870351373,40.73134287245169],[-73.97198878928002,40.72658321411803],[-73.9744981152197,40.72183335018933],[-73.97477822602225,40.718896579459255],[-73.97600954642573,40.715539479497174]]}}]}')}}]);
//# sourceMappingURL=515.bf6d319d.chunk.js.map